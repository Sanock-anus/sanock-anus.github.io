<!DOCTYPE html>
<html lang="ru">
<head>
    <meta name="yandex-verification" content="0ff9479251bdef9d" />
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–ê–•‚öôÔ∏è–í–ò–ö & GAME MEF</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
    <style>
        body { background-color: #1a1a1a; color: white; font-family: sans-serif; margin: 0; }
        .container { max-width: 800px; margin: 0 auto; padding: 20px; }
        header { background: #222; padding: 10px; text-align: center; border-bottom: 2px solid #e67e22; }
        .logo-img { height: 50px; margin: 0 10px; border-radius: 5px; }
        .cta-button, button { background: #e67e22; border: none; color: white; padding: 10px 15px; border-radius: 5px; cursor: pointer; transition: 0.3s; }
        .cta-button:hover, button:hover { background: #d35400; }
        input, textarea { background: #333; border: 1px solid #444; color: white; padding: 10px; border-radius: 5px; width: 100%; box-sizing: border-box; }
        .post { background: #2c3e50; padding: 15px; border-radius: 10px; margin-bottom: 15px; border-left: 5px solid #e67e22; }
        .reply { background: rgba(255,255,255,0.05); padding: 10px; border-radius: 5px; margin-top: 10px; font-size: 0.9em; border-left: 2px solid #555; }
        .vote-btn { background: none; border: none; cursor: pointer; color: #aaa; margin-right: 10px; padding: 5px; }
        .vote-btn:hover { color: #fff; }
        @keyframes fall { to { transform: translateY(105vh); } }
    </style>
</head>
<body class="theme-default">

    <header>
        <nav>
            <div class="logo">
                <img src="–ú–ê–•‚öôÔ∏è–í–ò–ö.png" alt="–õ–æ–≥–æ" class="logo-img">
                <img src="–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ WhatsApp 2025-08-28 –≤ 22.16.06_5d40c46f.jpg" alt="Logo 2" class="logo-img">
            </div>
            <ul style="list-style: none; display: flex; justify-content: center; gap: 20px; padding: 10px;">
                <li><a href="#about" style="color:white; text-decoration:none;">–û –Ω–∞—Å</a></li>
                <li><a href="#games" style="color:white; text-decoration:none;">–ò–≥—Ä—ã</a></li>
                <li><a href="#community" style="color:white; text-decoration:none;">–°–æ–æ–±—â–µ—Å—Ç–≤–æ</a></li>
            </ul>
        </nav>
    </header>

    <main class="container">
        <section id="hero" style="text-align:center; padding: 40px 0;">
            <h1>–ú–ê–•‚öôÔ∏è–í–ò–ö & GAME MEF</h1>
            <p>–ú—ã —Å–æ–∑–¥–∞—ë–º –∏–≥—Ä—ã. –ü–æ—á—Ç–∏ –≤—Å–µ –æ–Ω–∏ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ.</p>
            <div style="font-size: 1.2em; color: #e67e22; margin: 20px 0;">
                üì• –°–∫–∞—á–∏–≤–∞–Ω–∏–π: <span id="count-number">0</span>
            </div>
            <a href="#games" class="cta-button">–ò–ì–†–ê–¢–¨!</a>
        </section>

        <section id="community">
            <h2>–°–æ–æ–±—â–µ—Å—Ç–≤–æ ‚ùÑÔ∏è</h2>
            <div style="background: rgba(255,255,255,0.05); padding: 20px; border-radius: 15px; border: 1px solid #e67e22; margin-bottom: 30px;">
                <input type="text" id="c-name" placeholder="–í–∞—à–µ –∏–º—è" style="margin-bottom:10px;">
                <textarea id="c-msg" placeholder="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∏–ª–∏ —Å—Å—ã–ª–∫–∞ –Ω–∞ –≤–∏–¥–µ–æ..." style="margin-bottom:10px;"></textarea>
                <button id="send-msg" style="width:100%;">–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å</button>
            </div>
            <div id="posts-wall">–ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π...</div>
        </section>
    </main>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyBcQP8-B9zt_dKdj2Ns99H6aaqzQb8OnLc",
            authDomain: "makhovicksite.firebaseapp.com",
            projectId: "makhovicksite",
            storageBucket: "makhovicksite.firebasestorage.app",
            messagingSenderId: "245142284614",
            appId: "1:245142284614:web:fd01f94ef372ebc0ad1d47",
            databaseURL: "https://makhovicksite-default-rtdb.firebaseio.com"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–¥–º–∏–Ω–∞
        document.getElementById('c-name').onchange = function() {
            if(this.value === "–ú–ê–•‚öôÔ∏è–í–ò–ö-–∞–¥–º–∏–Ω") {
                const mail = prompt("–í–≤–µ–¥–∏—Ç–µ –ø–æ—á—Ç—É –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:");
                if(mail !== "sanokgameplay@gmail.com") {
                    alert("–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω!");
                    this.value = "";
                }
            }
        };

        // –í–∏–¥–µ–æ –ø–∞—Ä—Å–µ—Ä
        function parseVideo(text) {
            const ytReg = /(?:https?:\/\/)?(?:www\.)?(?:youtube\.com\/watch\?v=|youtu\.be\/)([a-zA-Z0-9_-]{11})/;
            const match = text.match(ytReg);
            return match ? `<br><iframe width="100%" height="315" src="https://www.youtube.com/embed/${match[1]}" frameborder="0" allowfullscreen style="margin-top:10px; border-radius:10px;"></iframe>` : "";
        }

        // –õ–∞–π–∫–∏
        window.vote = function(id, type, isReply = false, parentId = null) {
            let path = isReply ? `posts/${parentId}/replies/${id}/${type}` : `posts/${id}/${type}`;
            db.ref(path).transaction(c => (c || 0) + 1);
        };

        // –û—Ç–≤–µ—Ç—ã
        window.openReplyForm = function(id) {
            const el = document.getElementById('reply-form-' + id);
            el.style.display = el.style.display === 'none' ? 'block' : 'none';
        };

        window.sendReply = function(parentId) {
            const n = document.getElementById('c-name').value || "–ê–Ω–æ–Ω–∏–º";
            const t = document.getElementById('r-msg-' + parentId).value;
            if(t) {
                db.ref(`posts/${parentId}/replies`).push({
                    n, t, time: new Date().toLocaleString(), likes: 0, dislikes: 0
                });
                document.getElementById('r-msg-' + parentId).value = '';
                openReplyForm(parentId);
            }
        };

        window.toggleReplies = function(id) {
            const box = document.getElementById('reply-box-' + id);
            box.style.display = box.style.display === 'none' ? 'block' : 'none';
        };

        // –ì–ª–∞–≤–Ω—ã–π –ø–æ—Å—Ç
        document.getElementById('send-msg').onclick = () => {
            const n = document.getElementById('c-name').value || "–ê–Ω–æ–Ω–∏–º";
            const t = document.getElementById('c-msg').value;
            if(t) {
                db.ref('posts').push({ n, t, time: new Date().toLocaleString(), likes: 0, dislikes: 0 });
                document.getElementById('c-msg').value = '';
            }
        };

        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞
        db.ref('posts').on('value', snap => {
            const wall = document.getElementById('posts-wall');
            wall.innerHTML = '';
            const data = snap.val();
            if(!data) { wall.innerHTML = '–°–æ–æ–±—â–µ–Ω–∏–π –ø–æ–∫–∞ –Ω–µ—Ç.'; return; }

            for(let id in data) {
                const p = data[id];
                const videoHtml = parseVideo(p.t);
                const replyCount = p.replies ? Object.keys(p.replies).length : 0;
                
                let postHtml = `
                    <div class="post">
                        <div style="display:flex; justify-content:space-between; margin-bottom:10px;">
                            <strong style="color:#e67e22;">${p.n}</strong>
                            <small style="opacity:0.6;">${p.time}</small>
                        </div>
                        <div style="word-wrap: break-word;">${p.t}${videoHtml}</div>
                        <div style="margin-top:15px; display:flex; gap:10px;">
                            <button class="vote-btn" onclick="vote('${id}', 'likes')">üëç ${p.likes || 0}</button>
                            <button class="vote-btn" onclick="vote('${id}', 'dislikes')">üëé ${p.dislikes || 0}</button>
                            <button onclick="openReplyForm('${id}')" style="background:#34495e;">–û—Ç–≤–µ—Ç–∏—Ç—å</button>
                            ${replyCount ? `<button onclick="toggleReplies('${id}')" style="background:#f1c40f; color:#000;">–û—Ç–≤–µ—Ç—ã (${replyCount})</button>` : ''}
                        </div>
                        
                        <div id="reply-form-${id}" style="display:none; margin-top:15px;">
                            <textarea id="r-msg-${id}" placeholder="–í–∞—à –æ—Ç–≤–µ—Ç..."></textarea>
                            <button onclick="sendReply('${id}')" style="margin-top:5px; width:100%;">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                        </div>

                        <div id="reply-box-${id}" style="display:none; margin-left:30px; border-left: 2px solid #e67e22; padding-left:15px; margin-top:15px;">
                `;

                if(p.replies) {
                    for(let rId in p.replies) {
                        const r = p.replies[rId];
                        postHtml += `
                            <div class="reply">
                                <strong>${r.n}</strong>: ${r.t}
                                <div style="margin-top:5px;">
                                    <button class="vote-btn" onclick="vote('${rId}', 'likes', true, '${id}')">üëç ${r.likes || 0}</button>
                                    <button class="vote-btn" onclick="vote('${rId}', 'dislikes', true, '${id}')">üëé ${r.dislikes || 0}</button>
                                </div>
                            </div>
                        `;
                    }
                }
                postHtml += `</div></div>`;
                wall.insertAdjacentHTML('afterbegin', postHtml);
            }
        });

        // –°—á—ë—Ç—á–∏–∫ —Å–∫–∞—á–∏–≤–∞–Ω–∏–π
        const countRef = db.ref('downloads/total');
        countRef.on('value', (s) => document.getElementById('count-number').innerText = s.val() || 0);

        // –°–Ω–µ–≥
        setInterval(() => {
            const s = document.createElement('div');
            s.innerHTML = '‚ùÑ';
            s.style.cssText = `position:fixed; top:-20px; color:white; pointer-events:none; left:${Math.random()*100}vw; animation: fall ${Math.random()*3+2}s linear forwards; z-index:9999;`;
            document.body.appendChild(s);
            setTimeout(() => s.remove(), 5000);
        }, 300);
    </script>
</body>
</html>
